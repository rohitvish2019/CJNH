<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/prescriptionForm.css">
    <title>Prescription</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.min.js"
        integrity="sha512-ykZ1QQr0Jy/4ZkvKuqWn4iF3lqPZyij9iRv6sGqLRdTPkY69YX6+7wvVGmsdBbiIfN/8OdsI7HABjvEok6ZopQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
        integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.js" integrity="sha512-lOrm9FgT1LKOJRUXF3tp6QaMorJftUjowOWiDcG5GFZ/q7ukof19V0HKx/GWzXCdt9zYju3/KhBNdCLzK8b90Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.css" integrity="sha512-0p3K0H3S6Q4bEWZ/WmC94Tgit2ular2/n0ESdfEX8l172YyQj8re1Wu9s/HT9T/T2osUw5Gx/6pAZNk3UKbESw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        
</head>

<body onload="initilizeApp()">
    <div class="main-body" style="overflow: hidden;">
        <div class="header">
            <label for="" style="font-size: small;">Reg No. NH/9255/JUN-2023</label>
            <div class="name">
                <label style="font-size: 31px;font-weight: bolder; color: rgb(201, 8, 8);">डॉ. चंदा &nbsp;जैन
                    &nbsp;नर्सिंग &nbsp;होम</label>
                <label style="font-size: 18px; font-weight: 500;margin-top: 0.3%;">सिविल वार्ड नंबर 7 दमोह (म.
                    प्र.)</label>
                <label style="font-size: 14px;">Mob: 6263169195, Ph No: 07812-222441</label>
            </div>
            
        </div>
        <%let boldTure = 'bold'%>
        <%let boldFalse = '100'%>
        <div class="doctors-info">
            <div class="doc-info-left">
                <%if(user.Name == 'Dr Anuj Jain'){%>
                    <label class="doc-name" style="font-weight: bold;">डॉ. अनुज जैन</label>
                    <label style="font-weight: bold;">MBBS, DGO</label>
                    <br>
                <%}else{%>
                    <label class="doc-name" style="font-weight: 100;">डॉ. अनुज जैन</label>
                    <label style="font-weight: 100;">MBBS, DGO</label>
                <%}%>
                
                <div>
                    <label class="old-info">स्त्री रोग विशेषज्ञ</label>
                    <label class="old-info">CF. Sr. No. Addl./MPMC-7259</label>
                </div>

                <div>
                    <label class="old-info" style="font-size: 10px;">FMF LONDON CERTIFIED SONOGRAPHER [ID 17468]</label>
                </div>
                <div>
                    <label class="old-info">मिलने का समय</label>
                    <label class="old-info">सुबह 10 बजे से शाम 5 बजे तक</label>
                </div>
                

            </div>
            <div class="hospital-photo" style="display: flex;justify-content: center;flex-direction: column;align-items: center;margin-left: 3%;">
                <img style="background-color: black;" height="70%" width="60%" src="/images/CJNH_Logo_White.png" alt="">
                <label style="color: red;font-weight: bolder;">* रविवार अवकाश *</label>
            </div>
            <div class="doc-info-right">
                <%if(user.Name == 'Dr Swati Jain'){%>
                    <label class="doc-name" style="font-weight: bold;">डॉ. स्वाति जैन</label>
                    <label style="font-weight: bold;">MBBS, DGO</label>
                <%}else{%>
                    <label class="doc-name" style="font-weight: 100;">डॉ. स्वाति जैन</label>
                    <label style="font-weight: 100;">MBBS, DGO</label>
                    <br>
                <%}%>
                
                <label class="old-info">स्त्री रोग विशेषज्ञ</label>
                <label class="old-info">CF. SR. No. Addl./MPMC-6978</label>
                <div>
                    <label class="old-info">CERTIFIED COLPOSCOPIST [ MUMBAI ] </label>
                </div>
                <label class="old-info">मिलने का समय सुबह 11बजे से 1 बजे, 1:30 से शाम 3 बजे</label>
                <label class="old-info"></label>

            </div>
        </div>
        <div class="patient-info">
            <label hidden for="" id="visitId"><%=visit._id%></label>
            <div class="patient-data" style="width: 7%;">
                <small for=""><b>ID</b></small>
                <label for="" id=""><%=visit.Patient.Id%></label>
            </div>
            <div class="patient-data" style="width: 18%;">
                <small for=""><b>Name</b></small>
                <label for=""><%=visit.Patient.Name%></label>
            </div>
            <div class="patient-data" style="width: 18%;">
                <small for=""><b>Husband</b></small>
                <label for=""><%=visit.Patient.Husband%></label>
            </div>
            <div class="patient-data" style="width: 5%;">
                <small for=""><b>Age</b></small>
                <label for=""><%=visit.Patient.Age%>Y</label>
            </div>
            <div class="patient-data" style="width: 10%;">
                <small for=""><b>Weight</b></small>
                <label for="" style="margin-bottom: 5px;"><input onchange='saveWeight("<%=visit._id%>")' style="width: 32%;margin-bottom: 5px; display: inline;" type="number" name="" id="pweight" value="<%=visit.weight%>">Kg</label>
            </div>
            <div class="patient-data" style="width: 24%;">
                <small for=""><b>Address</b></small>
                <label for=""><%=visit.Patient.Address%></label>
            </div>
            <div class="patient-data" style="width: 18%; ">
                <small for=""><b>Date & Time</b></small>
                <%let months= ['Jan','Feb','Mar','Apr','May','Jun','July','Aug','Sep','Oct','Nov','Dec']%>
                <label style="font-size: small;">
                    
                    <%= new Date(visit.Visit_date).toLocaleDateString('en-IN',{year: 'numeric', month: '2-digit', day: '2-digit'})%>
                    <% let n = new Date(visit.updatedAt).toLocaleString('en-IN', {
                        hour: "2-digit",
                        minute: "2-digit",
                        });%>
                    <%=n%>
                </label>
            </div>
        </div>

        <div class="prescription-data">
            <div class="left-side">
                <div style="font-size: 13px;">
                    <div style="width: 100%;display: flex;">
                        <div style="width: 60%;">
                            <b style="display: block;">Complaint</b>
                            <textarea rows="3" cols="40" name="" id="complaint" placeholder=""></textarea>
                        </div>
                        <div style="width: 40% !important;margin-left: 5px;">
                            <% if(lastVisit && lastVisit.VisitData){ %>
                                <div style="margin-top: 2px;">
                                    LMP &nbsp;&nbsp;:&nbsp;&nbsp;<input style="width: 70%;" type="date" name="" id="lmpdate" onchange="addChanges('lmpdate')" value="<%= lastVisit.VisitData.lmpdate %>">
                                </div>
                                <div style="margin-top: 2px;">
                                    EDD &nbsp;&nbsp;:&nbsp;&nbsp;<input style="width: 70%;" type="date" name="" id="edddate" onchange="addChanges('edddate')" value="<%= lastVisit.VisitData.edddate %>">
                                </div>
                                
                                <div style="margin-top: 2px;">
                                    C.EDD&nbsp;: <input style="width: 70%;" type="date" name="" id="cedddate" onchange="addChanges('cedddate'), calculateFullGAA()" value="<%= lastVisit.VisitData.cedddate %>">
                                </div>
                                <div style="margin-top: 2px;">
                                    GA &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;<input type="text" style="width: 70%;" name="" id="calculatedTime" onchange="addChanges('calculatedTime'),calculateFullGAA()">
                                </div>
                            <%}else{%>
                                <div style="margin-top: 2px;">
                                    LMP &nbsp;&nbsp;:&nbsp;&nbsp;<input style="width: 70%;" type="date" name="" id="lmpdate" onchange="addChanges('lmpdate')">
                                </div>
                                <div style="margin-top: 2px;">
                                    EDD &nbsp;&nbsp;:&nbsp;&nbsp;<input style="width: 70%;" type="date" name="" id="edddate" onchange="addChanges('edddate')">
                                </div>
                                
                                <div style="margin-top: 2px;">
                                    C.EDD&nbsp;: <input style="width: 70%;" type="date" name="" id="cedddate" onchange="addChanges('cedddate'),calculateFullGAA()">
                                </div>
                                <div style="margin-top: 2px;">
                                    GA &nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;<input type="text" style="width: 70%;" name="" id="calculatedTime" onchange="addChanges('edddate')">
                                </div>
                            <%}%>
                            
                        </div>
                    </div>
                    <div>
                        <b>History</b>
                        <% if(lastVisit && lastVisit.VisitData){ %>
                            <textarea rows="3" style="width: 100%;" name="" id="history" placeholder=""><%=lastVisit == undefined ? '' : lastVisit.VisitData.history%></textarea>
                        <%}else{%>
                            <textarea rows="3" style="width: 100%;" name="" id="history" placeholder=""></textarea>
                        <%}%>
                    </div>
                    <div>
                        <b>O/E</b>
                        <textarea rows="5" style="width: 100%;" name="" id="OEs" placeholder="">
AFEBRILE, &nbsp;BP =  MM OF HG, &nbsp;P = BPM, &nbsp; PALLOR 
P/A 
P/V </textarea>
                    </div>
                    
                </div>
                <div class="medicines" style="padding-left: 3px;">
                    <div style="display: flex;justify-content: space-between;">
                        <div style="width: 99.5%;">
                            <div style="display: flex;">
                                <input style="width: 95% !important;" type="text" placeholder="Medicine" id="searchBox" list="meds">
                                <datalist id="meds">
                                    <%for(let i=0;i<medsList.length;i++){%>
                                    <option value="<%=medsList[i].Name%>$<%=medsList[i].Dosage%>$<%=medsList[i].Duration%>$<%=medsList[i].Composition%>$<%=medsList[i].Category.toLowerCase()%>"></option>
                                    <%}%>
                                </datalist>
                                
                                <input style="font-size: large;" type="button" id="AddMed" value="Add" onclick="addMed()">
                            </div>
                            <div style="height: 400px;">
                                <div  style="font-size: 14px !important;">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Medicine</th>
                                                <th>Dosage</th>
                                                <th>Time-Freq-Duration</th>
                                            </tr>
                                        </thead>
                                        <tbody id="prescribedMeds" style="font-size: small;">
                                            <!--
                                            <tr>
                                                <td style="width: 33%;">
                                                    <label style="display: block;">Ecosprinb-AV 75/10 Capsule</label>
                                                    <small style="font-size: 10px !important;"><b>Comp. </b>Aspirin 75 MG + Atorvastatin 10 MG</small>
                                                </td>
                                                <td style="width: 10%;">
                                                    0--0--1
                                                </td>
                                                <td style="font-size: 12px;width: 33%;">
                                                    Night-After food everyday for 6 months
                                                </td>
                                            </tr>
                                            -->
                                        </tbody>
                                    </table>
                                    
                                    
                                </div>
                                
                            </div>
                            <div style="text-align: end;padding-right: 10px;">
                                <label><%=visit.Doctor%></label>
                            </div>
                            
                        </div>
    
                    </div>
                </div>
            </div>

            <div class="right-side">
                <div class="investigationItems" style="font-size: 13px;">
                    <div style="text-align: center;">
                        <label style="text-align: center;font-weight: bold;margin-top: 0%;">Investigation Advice</label>
                    </div>
                    <div style="text-align: left;">
                        <input type="checkbox"><label style="text-align: center;font-weight: bold;margin-top: 0%;">&nbsp;Outside
                            Tests</label>
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">CBC</label>
                        <input style="width: 56%;border: none;border-bottom: 1px dotted black;" type="text"
                            onchange="addChanges('CBC')" id="CBC">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">Bl gr & Rh</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('Blgr')" id="Blgr" list="values1">
                        <datalist id="values1">
                            <option value="A Positive"></option>
                            <option value="B Positive"></option>
                            <option value="AB Positive"></option>
                            <option value="O Positive"></option>
                            <option value="A Negative"></option>
                            <option value="B Negative"></option>
                            <option value="AB Negative"></option>
                            <option value="O Negative"></option>
                        </datalist>
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">RBS</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('RBS')" id="RBS">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">HIV</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('HIV')" id="HIV" list="values2">
                        <datalist id="negpos">
                            <option value="Negative">Negative</option>
                            <option value="Positive">Positive</option>
                        </datalist>
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">HBsAg</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('HBsAg')" id="HBsAg" list="values2">
                    </div>
                    <datalist id="values2">
                        <option value="Nil"></option>
                        <option value="Reactive"></option>
                        <option value="Non-Reactive"></option>
                    </datalist>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">TSH</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('TSH')" id="TSH">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">&nbsp&nbsp;&nbsp; DM</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('DM')" id="DM">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">Urine P.test</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('Urine-Ptest')" id="Urine-Ptest" list="negpos">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">&nbsp&nbsp;&nbsp; Albumin</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('Urine-alb')" id="Urine-alb" list="uri">
                    </div>
                    <datalist id="uri">
                        <option value="Nil">Nil</option>
                        <option value="Traces">Traces</option>
                        <option value="+">+</option>
                        <option value="++">++</option>
                        <option value="+++">+++</option>
                    </datalist>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">&nbsp&nbsp;&nbsp; Sugar</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('Urine-sugar')" id="Urine-sugar" list="uri">
                    </div>
                    

                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;"><b>USG Obst</b></label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('USG-Obst')" id="USG-Obst" list="usglist">
                    </div>
                    <datalist id="usglist">
                        <option value="GA"></option>
                        <option value="FWB"></option>
                        <option value="NT/NB/PE Screening"></option>
                        <option value="Target Scan"></option>
                        <option value="Growth Scan"></option>
                        <option value="Col. Dop."></option>
                        <option value="2D Foetal echo"></option>
                    </datalist>
                    
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">&nbsp&nbsp;&nbsp; L.Abd</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('USG-LAbd')" id="USG-LAbd">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 33%;">&nbsp&nbsp;&nbsp; W.Abd</label>
                        <input style="width: 56%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('USG-WAbd')" id="USG-WAbd">
                    </div>
                    <div>
                        <input type="checkbox" name="" id="">
                        <label style="width: 42%;">Semen Analysis</label>
                        <input style="width: 46%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('SemenAnalysis')" id="SemenAnalysis">
                    </div>
                    <div>
                        <label style="width: 19%;">Other</label>
                        <input style="width: 78%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('otheInv')" id="otheInv">
                    </div>
                </div>
                <div style="margin-top: 25px;margin-left: 2%;">
                    <b>Other advice</b>
                    <textarea rows="5" style="width: 99%;border-bottom: none;" name="" id="OtherAdvice" placeholder=""></textarea>
                </div>

                <div
                    style="font-size: 13px;padding-left: 5px;margin-top: 20px;display: flex;flex-direction: column;justify-content: space-between;">
                    <div style="text-align: center;">
                        <label style="text-align: center;font-weight: bold;margin-top: 0%;">Miscellaneous</label>
                    </div>
                    <div>
                        <label style="width: 35%;">T1</label>
                        <input style="width: 63%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('T1')" id="T1" list="vals">
                    </div>

                    <div>
                        <label style="width: 35%;">T2</label>
                        <input style="width: 63%;border: none;border-bottom: .5px dotted black;" type="text" onchange="addChanges('T2')" id="T2" list="vals">
                        <datalist id="vals">
                            <option value="Yes"></option>
                            <option value="No"></option>
                        </datalist>
                    </div>

                    <div>
                        <label style="width: 35%;">NT on</label>
                        <input style="width: 63%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('NT')" id="NT">
                    </div>

                    <div>
                        <label style="width: 35%;">TS on</label>
                        <input style="width: 63%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('TS')" id="TS">
                    </div>

                    <div>
                        <label style="width: 35%;">CD on</label>
                        <input style="width: 63%;border: none;border-bottom: .5px dotted black;" type="text"
                            onchange="addChanges('CD')" id="CD">
                    </div>
                    <div>
                        <label style="width: 35%;">F/up on</label>
                        <input style="width: 63%;border: none;border-bottom: .5px dotted black;" type="text"
                            onload="addEmptyValues('FUP')" onchange="addChanges('FUP')" id="FUP" list="fuplist">

                        <datalist id="fuplist">
                            <option value="1 महीने में"></option>
                            <option value="15 दिन में"></option>
                            <option value="10 दिन में"></option>
                            <option value="7 दिन में"></option>
                            <option value="महीने के D2-D3 scan"></option>
                            <option value="महीने के D5-D10 scan"></option>
                        </datalist>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    <div style="width: 730px;display: flex;justify-content: center;margin-top: 15px;">
        <button class="btn btn-success" style="width: 70%;" id="printButton" onclick="printPrescription()">Save &
            Print</button>
    </div>
    <script src="/js/prescriptionForm.js"></script>

    
</body>
<div id="fileInputs" style="position: absolute;top: 5%; left: 65%;">
    Enter file name <input type="text" name="" id="fileName">
    <input  type="file" id="file" accept="*" onchange="setname()">
    <button style="padding: 5px;" onclick="uploadReport('<%=visit._id%>','<%=visit.Patient._id%>')">Upload</button>
    <div style="margin-top: 5%;">
        <label for="">Other documents</label>
        <table border="1px solid gray">
            <thead>
                <tr>
                    <th>Documents List</th>
                </tr>
            </thead>
            
            <tbody id="otherDocs">
                <%for(let i=0;i<visit.OtherDocs.length;i++){%>
                    <tr>
                        <td><a target="_blank" href="<%=visit.OtherDocs[i]%>"><%=visit.OtherDocs[i].toString().split('_')[3]%></a></td>
                    </tr>
                <%}%>
            </tbody>
        </table>
        <div id="audioInput" style="position: fixed;top: 60%;left: 55%;display: none;">
            <h1>Audio input</h1>
            <button id="startButton">Start Listening</button>
            <button id="stopButton" disabled>Stop Listening</button>
        </div>
        
    
    </div>
</div>


</html>